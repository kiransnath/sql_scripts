Insert into <SCHEMA>.<TABLE>
(PRTY_ID_SALESPERS_FK_SRC_BS,PRTY_ID_SALESPERS_FK_SRC_XREF,PRTY_ID_CUST_FK_SRC_BS,PKEY_SRC_OBJECT,ROWID_SYSTEM,STATUS, LOAD_DATE)
(select /*+ parallel(8) */ distinct rlnshp.PRTY_ID_SALESPERS_FK as PRTY_ID_SALESPERS_FK_SRC_BS,
RXRF.PRTY_ID_SALESPERS_FK as PRTY_ID_SALESPERS_FK_SRC_XREF,
rlnshp.PRTY_ID_CUST_FK AS PRTY_ID_CUST_FK_SRC_BS,
RXRF.PKEY_SRC_OBJECT,
RXRF.ROWID_SYSTEM,
'NEW',
sysdate
from <SCHEMA>.<TABLE> rlnshp
JOIN <SCHEMA>.<TABLE> prty
ON rlnshp.PRTY_ID_SALESPERS_FK = prty.ROWID_OBJECT
inner join <SCHEMA>.<TABLE> RXRF
on rlnshp.ROWID_OBJECT=RXRF.ROWID_OBJECT
where rlnshp.CR_STS_CD='ACT' and rlnshp.hub_state_ind=1 and prty.HUB_STATE_IND=1
and RXRF.CR_STS_CD='ACT' and RXRF.hub_state_ind=1
GROUP BY rlnshp.PRTY_ID_SALESPERS_FK, RXRF.PRTY_ID_SALESPERS_FK,RXRF.PKEY_SRC_OBJECT, RXRF.ROWID_SYSTEM, 'NEW',
rlnshp.PRTY_ID_CUST_FK, sysdate
HAVING SUM(CASE WHEN prty.rowid_system = 'HRMS' THEN 1 ELSE 0 END) =0);

commit;
